<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baby Card Experience</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        /* Animated background particles */
        body::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.3), transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(138, 43, 226, 0.2), transparent 50%);
            animation: bgShift 15s ease-in-out infinite;
        }

        @keyframes bgShift {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.1); }
        }

        #startButton {
            position: absolute;
            z-index: 1000;
            padding: 25px 50px;
            font-size: 26px;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
            transition: all 0.4s ease;
            letter-spacing: 1px;
        }

        #startButton:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 50px rgba(102, 126, 234, 0.6);
        }

        #startButton:active {
            transform: translateY(-2px) scale(1.02);
        }

        .carousel-container {
            position: relative;
            width: 500px;
            height: 500px;
            perspective: 1500px;
            display: none;
        }

        .carousel-container.active {
            display: block;
            animation: fadeIn 1s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .carousel {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            animation: none;
        }

        .carousel.spinning {
            animation: spin3times 12s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }

        @keyframes spin3times {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(1080deg); }
        }

        .carousel-item {
            position: absolute;
            width: 320px;
            height: 450px;
            left: 50%;
            top: 50%;
            transform-origin: center;
            backface-visibility: hidden;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 60px rgba(0, 0, 0, 0.5);
            border: 3px solid rgba(255, 255, 255, 0.1);
        }

        .carousel-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .deck-container {
            position: relative;
            width: 340px;
            height: 480px;
            display: none;
        }

        .deck-container.active {
            display: block;
            animation: deckAppear 1.2s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes deckAppear {
            0% {
                opacity: 0;
                transform: scale(0) rotate(-180deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        .card {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            border-radius: 20px;
            cursor: pointer;
        }

        .card:hover:not(.flipped):not(.removed) {
            transform: translateY(-15px) scale(1.03) !important;
            box-shadow: 0 25px 70px rgba(102, 126, 234, 0.6) !important;
        }

        .card.flipped {
            transform: rotateY(180deg) scale(1.1) !important;
            pointer-events: none;
            z-index: 1000 !important;
        }

        .card.removed {
            transform: translateX(1200px) rotate(45deg) scale(0.5) !important;
            opacity: 0 !important;
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.6);
            border: 3px solid rgba(255, 255, 255, 0.2);
        }

        .card-face img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .card-back {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .card-front {
            transform: rotateY(180deg);
            background: white;
        }

        .poem-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            padding: 50px;
            border-radius: 30px;
            max-width: 700px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.7);
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 2000;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }

        .poem-container.visible {
            opacity: 1;
            pointer-events: all;
            transform: translate(-50%, -50%) scale(1);
        }

        .poem-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
            background-size: 200% 100%;
            animation: shimmer 3s ease infinite;
        }

        @keyframes shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .poem-container img {
            width: 100%;
            max-height: 350px;
            object-fit: cover;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .poem-text {
            font-size: 20px;
            line-height: 2;
            color: #2d3748;
            white-space: pre-line;
            text-align: center;
            font-style: italic;
            animation: fadeInText 0.8s ease 0.3s both;
        }

        @keyframes fadeInText {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .close-button {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .close-button:hover {
            transform: rotate(90deg) scale(1.1);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .audio-controls {
            position: fixed;
            bottom: 40px;
            right: 40px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 18px 25px;
            border-radius: 50px;
            display: flex;
            gap: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 50;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }

        .audio-controls button {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            transition: all 0.3s ease;
            filter: grayscale(0.3);
        }

        .audio-controls button:hover {
            transform: scale(1.3);
            filter: grayscale(0);
        }

        .audio-controls button:active {
            transform: scale(1.1);
        }

        /* Custom scrollbar */
        .poem-container::-webkit-scrollbar {
            width: 8px;
        }

        .poem-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }

        .poem-container::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }

        /* Counter display */
        .card-counter {
            position: fixed;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            color: #667eea;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 100;
            display: none;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }

        .card-counter.visible {
            display: block;
            animation: slideDown 0.5s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .completion-message {
            color: white;
            text-align: center;
            font-size: 32px;
            font-weight: 600;
            animation: completionPulse 2s ease infinite;
            text-shadow: 0 0 20px rgba(102, 126, 234, 0.8);
        }

        @keyframes completionPulse {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .carousel-container {
                width: 350px;
                height: 350px;
            }

            .carousel-item {
                width: 250px;
                height: 350px;
            }

            .deck-container {
                width: 280px;
                height: 400px;
            }

            .poem-container {
                padding: 30px;
                max-width: 90%;
            }

            .poem-text {
                font-size: 18px;
            }

            #startButton {
                padding: 20px 40px;
                font-size: 22px;
            }
        }
    </style>
</head>
<body>
    <button id="startButton">‚ú® Begin Journey ‚ú®</button>

    <div class="card-counter" id="cardCounter">
        Card <span id="currentCard">1</span> of <span id="totalCards">3</span>
    </div>

    <div class="carousel-container" id="carouselContainer">
        <div class="carousel" id="carousel"></div>
    </div>

    <div class="deck-container" id="deckContainer"></div>

    <div class="poem-container" id="poemContainer">
        <button class="close-button" id="closePoem">√ó</button>
        <img id="poemImage" src="" alt="Card Image">
        <div class="poem-text" id="poemText"></div>
    </div>

    <div class="audio-controls">
        <button id="playPause" title="Play/Pause">‚ñ∂Ô∏è</button>
        <button id="mute" title="Mute/Unmute">üîä</button>
    </div>

    <audio id="backgroundMusic" loop>
        <source src="own.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Configuration - Add your images and poems here
        const cardsData = [
            {
                frontImage: 'one.jpeg',
                poem: `In twilight's gentle embrace,
Where shadows dance and dreams take place,
A moment captured, soft and true,
A memory painted just for you.

The stars above begin to gleam,
Reflecting every hope and dream,
In silence, wisdom finds its way,
Guiding us through night to day.`
            },
            {
                frontImage: 'three.jpeg',
                poem: `Through whispered winds and morning dew,
The world awakens, fresh and new,
Each petal holds a secret song,
A melody where hearts belong.

With every breath, with every beat,
Life's gentle rhythms we repeat,
In nature's arms we find our peace,
Where all our worries gently cease.`
            },
            {
                frontImage: 'two.jpeg',
                poem: `Beneath the stars that gently gleam,
We chase the fragments of a dream,
In every heartbeat, every sigh,
We find the courage to fly high.

The path ahead may twist and bend,
But every journey finds its end,
With hope as compass, love as guide,
We walk through life with hearts open wide.`
            },
            {
                frontImage: 'four.jpeg',
                poem: `Time flows like rivers to the sea,
Carrying hopes of what will be,
In silent moments, peace we find,
A gentle touch on heart and mind.

Each passing second, pure and true,
Brings endless possibilities anew,
The present moment, here and now,
Is all we need to teach us how.`
            },
            {
                frontImage: 'five.jpeg',
                poem: `Among the clouds and endless sky,
Where dreams are born and spirits fly,
We hold the light within our soul,
And find the strength to reach our goal.

With wings of faith and hearts so pure,
We face each challenge and endure,
For in the end, we come to see,
The power lies in being free.`
            },
            {
                frontImage: 'six.jpeg',
                poem: `A single smile, soft as dawn's first light,
Unravels shadows I did not know I wore.
In its quiet curve, the world feels right,
A promise whispered, asking nothing more.`
            },
            {
                frontImage: 'seven.jpeg',
                poem: `When falling stars slipped loose from heaven's hand,
They brushed the night and learned the art of hue.
Each burning wish, too bright to ever land,
Became a thread of red, of gold, of blue.

They kissed the dark, then broke in gentle light,
And where they fell, the sky learned how to feel.
A rainbow bloomed from longing and from flight‚Äî
Proof love can fall, and still become what's real.`
            }
        ];

        const backCardImage = 'Back.webp';

        // State management
        let currentState = 'initial';
        let currentCardIndex = 0;
        const audio = document.getElementById('backgroundMusic');
        const startButton = document.getElementById('startButton');
        const carouselContainer = document.getElementById('carouselContainer');
        const carousel = document.getElementById('carousel');
        const deckContainer = document.getElementById('deckContainer');
        const poemContainer = document.getElementById('poemContainer');
        const poemImage = document.getElementById('poemImage');
        const poemText = document.getElementById('poemText');
        const closePoem = document.getElementById('closePoem');
        const playPauseBtn = document.getElementById('playPause');
        const muteBtn = document.getElementById('mute');
        const cardCounter = document.getElementById('cardCounter');
        const currentCardSpan = document.getElementById('currentCard');
        const totalCardsSpan = document.getElementById('totalCards');

        // Initialize carousel
        function initCarousel() {
            const angleIncrement = 360 / cardsData.length;
            const radius = 350;

            cardsData.forEach((card, index) => {
                const item = document.createElement('div');
                item.className = 'carousel-item';
                const angle = angleIncrement * index;
                const x = Math.sin(angle * Math.PI / 180) * radius;
                const z = Math.cos(angle * Math.PI / 180) * radius;
                
                item.style.transform = `translate(-50%, -50%) translateX(${x}px) translateZ(${z}px) rotateY(${-angle}deg)`;
                
                const img = document.createElement('img');
                img.src = card.frontImage;
                img.alt = `Card ${index + 1}`;
                item.appendChild(img);
                carousel.appendChild(item);
            });
        }

        // Initialize deck with proper stacking - IMPROVED FOR 7+ CARDS
        function initDeck() {
            // Calculate dynamic offsets based on number of cards
            // This ensures all cards remain visible even with many cards
            const maxStackOffset = 1.5; // Reduced from 2-3 for better visibility with more cards
            const maxScaleReduction = 0.006; // Reduced from 0.008-0.015 for subtler scaling
            
            cardsData.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                
                // Store the card's original index as a data attribute
                cardElement.dataset.cardIndex = index;
                
                // Calculate position from back of deck (index 0 = bottom, last index = top)
                const positionFromBack = cardsData.length - 1 - index;
                
                // Apply offsets - smaller values work better with more cards
                const stackOffset = positionFromBack * maxStackOffset;
                const scaleOffset = positionFromBack * maxScaleReduction;
                
                cardElement.style.transform = `translateY(${-stackOffset}px) translateX(${stackOffset}px) scale(${1 - scaleOffset})`;
                cardElement.style.zIndex = cardsData.length - index;
                cardElement.style.boxShadow = `0 ${15 + stackOffset}px ${50 + stackOffset * 2}px rgba(0, 0, 0, ${0.4 + index * 0.05})`;
                
                const cardBack = document.createElement('div');
                cardBack.className = 'card-face card-back';
                const backImg = document.createElement('img');
                backImg.src = backCardImage;
                backImg.alt = 'Card back';
                cardBack.appendChild(backImg);
                
                const cardFront = document.createElement('div');
                cardFront.className = 'card-face card-front';
                const frontImg = document.createElement('img');
                frontImg.src = card.frontImage;
                frontImg.alt = `Card ${index + 1} front`;
                cardFront.appendChild(frontImg);
                
                cardElement.appendChild(cardBack);
                cardElement.appendChild(cardFront);
                deckContainer.appendChild(cardElement);

                cardElement.addEventListener('click', () => handleCardClick(cardElement));
            });

            totalCardsSpan.textContent = cardsData.length;
        }

        // Handle card click - FIXED to work after card removals
        function handleCardClick(clickedCard) {
            const cardIndex = parseInt(clickedCard.dataset.cardIndex);
            
            // Only allow clicking the top card (current card)
            if (cardIndex !== currentCardIndex) return;
            
            // Disable clicking on all cards during animation
            const allCards = deckContainer.querySelectorAll('.card');
            allCards.forEach(card => card.style.pointerEvents = 'none');
            
            clickedCard.classList.add('flipped');
            
            setTimeout(() => {
                poemImage.src = cardsData[cardIndex].frontImage;
                poemText.textContent = cardsData[cardIndex].poem;
                poemContainer.classList.add('visible');
            }, 400);
        }

        // Start experience
        startButton.addEventListener('click', () => {
            startButton.style.opacity = '0';
            startButton.style.transform = 'scale(0.5)';
            
            setTimeout(() => {
                startButton.style.display = 'none';
                carouselContainer.classList.add('active');
                carousel.classList.add('spinning');
                
                // Play audio
                audio.volume = 0.5;
                audio.play().catch(e => {
                    console.log('Audio autoplay prevented. User interaction required.');
                    playPauseBtn.textContent = '‚ñ∂Ô∏è';
                });

                // After 3 spins (12 seconds), transition to deck
                setTimeout(() => {
                    carouselContainer.style.opacity = '0';
                    
                    setTimeout(() => {
                        carouselContainer.classList.remove('active');
                        deckContainer.classList.add('active');
                        cardCounter.classList.add('visible');
                        currentState = 'deck';
                        updateCardCounter();
                    }, 800);
                }, 12000);
            }, 300);
        });

        // Update card counter
        function updateCardCounter() {
            currentCardSpan.textContent = currentCardIndex + 1;
        }

        // Close poem and reveal next card
        closePoem.addEventListener('click', () => {
            poemContainer.classList.remove('visible');
            
            // Find the card that matches the current index
            const allCards = deckContainer.querySelectorAll('.card');
            let currentCard = null;
            
            allCards.forEach(card => {
                if (parseInt(card.dataset.cardIndex) === currentCardIndex) {
                    currentCard = card;
                }
            });
            
            if (!currentCard) return;
            
            setTimeout(() => {
                currentCard.classList.add('removed');
                
                setTimeout(() => {
                    currentCard.remove();
                    currentCardIndex++;
                    updateCardCounter();
                    
                    // Re-enable clicking on remaining cards
                    const remainingCards = deckContainer.querySelectorAll('.card');
                    remainingCards.forEach(card => card.style.pointerEvents = 'auto');
                    
                    if (currentCardIndex >= cardsData.length) {
                        cardCounter.classList.remove('visible');
                        deckContainer.innerHTML = '<div class="completion-message">‚ú® what a Beauty Queen‚ú®<br><small style="font-size: 18px; opacity: 0.8;">Did you have fun admiring my future queen </small></div>';
                    }
                }, 800);
            }, 300);
        });

        // Audio controls
        playPauseBtn.addEventListener('click', () => {
            if (audio.paused) {
                audio.play().then(() => {
                    playPauseBtn.textContent = '‚è∏Ô∏è';
                }).catch(e => {
                    console.log('Audio play failed:', e);
                });
            } else {
                audio.pause();
                playPauseBtn.textContent = '‚ñ∂Ô∏è';
            }
        });

        muteBtn.addEventListener('click', () => {
            audio.muted = !audio.muted;
            muteBtn.textContent = audio.muted ? 'üîá' : 'üîä';
        });

        // Update play button when audio plays/pauses
        audio.addEventListener('play', () => {
            playPauseBtn.textContent = '‚è∏Ô∏è';
        });

        audio.addEventListener('pause', () => {
            playPauseBtn.textContent = '‚ñ∂Ô∏è';
        });

        // Initialize on load
        initCarousel();
        initDeck();
    </script>
</body>
</html>